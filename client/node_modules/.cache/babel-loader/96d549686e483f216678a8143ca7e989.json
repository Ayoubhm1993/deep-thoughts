{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/AYOUB/Desktop/challenges/mern-21/deep-thoughts/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/AYOUB/Desktop/challenges/mern-21/deep-thoughts/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/AYOUB/Desktop/challenges/mern-21/deep-thoughts/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import{Redirect,useParams}from'react-router-dom';import Auth from'../utils/auth';import{ADD_FRIEND}from'../utils/mutations';import{useQuery,useMutation}from'@apollo/react-hooks';import ThoughtList from'../components/ThoughtList';import FriendList from'../components/FriendList';import ThoughtForm from'../components/ThoughtForm';import{QUERY_USER,QUERY_ME}from'../utils/queries';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Profile=function Profile(){var _useParams=useParams(),userParam=_useParams.username;var _useMutation=useMutation(ADD_FRIEND),_useMutation2=_slicedToArray(_useMutation,1),addFriend=_useMutation2[0];var _useQuery=useQuery(userParam?QUERY_USER:QUERY_ME,{variables:{username:userParam}}),loading=_useQuery.loading,data=_useQuery.data;var user=(data===null||data===void 0?void 0:data.me)||(data===null||data===void 0?void 0:data.user)||{};// redirect to personal profile page if username is the logged-in user's\nif(Auth.loggedIn()&&Auth.getProfile().data.username===userParam){return/*#__PURE__*/_jsx(Redirect,{to:\"/profile\"});}if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}if(!(user===null||user===void 0?void 0:user.username)){return/*#__PURE__*/_jsx(\"h4\",{children:\"You need to be logged in to see this page. Use the navigation links above to sign up or log in!\"});}var handleClick=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return addFriend({variables:{id:user._id}});case 3:_context.next=8;break;case 5:_context.prev=5;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 8:case\"end\":return _context.stop();}}},_callee,null,[[0,5]]);}));return function handleClick(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-row mb-3\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"bg-dark text-secondary p-3 display-inline-block\",children:[\"Viewing \",userParam?\"\".concat(user.username,\"'s\"):'your',\" profile.\"]}),userParam&&/*#__PURE__*/_jsx(\"button\",{className:\"btn ml-auto\",onClick:handleClick,children:\"Add Friend\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-row justify-space-between mb-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-12 mb-3 col-lg-8\",children:/*#__PURE__*/_jsx(ThoughtList,{thoughts:user.thoughts,title:\"\".concat(user.username,\"'s thoughts...\")})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-12 col-lg-3 mb-3\",children:/*#__PURE__*/_jsx(FriendList,{username:user.username,friendCount:user.friendCount,friends:user.friends})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:!userParam&&/*#__PURE__*/_jsx(ThoughtForm,{})})]});};export default Profile;","map":{"version":3,"sources":["C:/Users/AYOUB/Desktop/challenges/mern-21/deep-thoughts/client/src/pages/Profile.js"],"names":["React","Redirect","useParams","Auth","ADD_FRIEND","useQuery","useMutation","ThoughtList","FriendList","ThoughtForm","QUERY_USER","QUERY_ME","Profile","userParam","username","addFriend","variables","loading","data","user","me","loggedIn","getProfile","handleClick","id","_id","console","error","thoughts","friendCount","friends"],"mappings":"4hBAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,QAAT,CAAmBC,SAAnB,KAAoC,kBAApC,CACA,MAAOC,CAAAA,IAAP,KAAiB,eAAjB,CAEA,OAASC,UAAT,KAA2B,oBAA3B,CACA,OAASC,QAAT,CAAmBC,WAAnB,KAAsC,qBAAtC,CAEA,MAAOC,CAAAA,WAAP,KAAwB,2BAAxB,CACA,MAAOC,CAAAA,UAAP,KAAuB,0BAAvB,CACA,MAAOC,CAAAA,WAAP,KAAwB,2BAAxB,CAEA,OAASC,UAAT,CAAqBC,QAArB,KAAqC,kBAArC,C,wFAEA,GAAMC,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,EAAM,gBACYV,SAAS,EADrB,CACFW,SADE,YACZC,QADY,kBAGAR,WAAW,CAACF,UAAD,CAHX,8CAGbW,SAHa,gCAKMV,QAAQ,CAACQ,SAAS,CAAGH,UAAH,CAAgBC,QAA1B,CAAoC,CACpEK,SAAS,CAAE,CAAEF,QAAQ,CAAED,SAAZ,CADyD,CAApC,CALd,CAKZI,OALY,WAKZA,OALY,CAKHC,IALG,WAKHA,IALG,CASpB,GAAMC,CAAAA,IAAI,CAAG,CAAAD,IAAI,OAAJ,EAAAA,IAAI,SAAJ,QAAAA,IAAI,CAAEE,EAAN,IAAYF,IAAZ,SAAYA,IAAZ,iBAAYA,IAAI,CAAEC,IAAlB,GAA0B,EAAvC,CACF;AACA,GAAIhB,IAAI,CAACkB,QAAL,IAAmBlB,IAAI,CAACmB,UAAL,GAAkBJ,IAAlB,CAAuBJ,QAAvB,GAAoCD,SAA3D,CAAsE,CACpE,mBAAO,KAAC,QAAD,EAAU,EAAE,CAAC,UAAb,EAAP,CACD,CAEC,GAAII,OAAJ,CAAa,CACX,mBAAO,mCAAP,CACD,CAED,GAAI,EAACE,IAAD,SAACA,IAAD,iBAACA,IAAI,CAAEL,QAAP,CAAJ,CAAqB,CACnB,mBACE,uHADF,CAKD,CAED,GAAMS,CAAAA,WAAW,0FAAG,yKAEVR,CAAAA,SAAS,CAAC,CACdC,SAAS,CAAE,CAAEQ,EAAE,CAAEL,IAAI,CAACM,GAAX,CADG,CAAD,CAFC,sFAMhBC,OAAO,CAACC,KAAR,cANgB,mEAAH,kBAAXJ,CAAAA,WAAW,0CAAjB,CAUA,mBACE,oCACE,aAAK,SAAS,CAAC,eAAf,wBACA,YAAI,SAAS,CAAC,iDAAd,sBACUV,SAAS,WAAMM,IAAI,CAACL,QAAX,OAA0B,MAD7C,eADA,CAICD,SAAS,eACd,eAAQ,SAAS,CAAC,aAAlB,CAAgC,OAAO,CAAEU,WAAzC,wBALI,GADF,cAYE,aAAK,SAAS,CAAC,qCAAf,wBACJ,YAAK,SAAS,CAAC,sBAAf,uBACE,KAAC,WAAD,EAAa,QAAQ,CAAEJ,IAAI,CAACS,QAA5B,CAAsC,KAAK,WAAKT,IAAI,CAACL,QAAV,kBAA3C,EADF,EADI,cAKJ,YAAK,SAAS,CAAC,sBAAf,uBACE,KAAC,UAAD,EACE,QAAQ,CAAEK,IAAI,CAACL,QADjB,CAEE,WAAW,CAAEK,IAAI,CAACU,WAFpB,CAGE,OAAO,CAAEV,IAAI,CAACW,OAHhB,EADF,EALI,GAZF,cAyBJ,YAAK,SAAS,CAAC,MAAf,UAAuB,CAACjB,SAAD,eAAc,KAAC,WAAD,IAArC,EAzBI,GADF,CA6BD,CAlED,CAmEA,cAAeD,CAAAA,OAAf","sourcesContent":["import React from 'react';\r\nimport { Redirect, useParams } from 'react-router-dom';\r\nimport Auth from '../utils/auth';\r\n\r\nimport { ADD_FRIEND } from '../utils/mutations';\r\nimport { useQuery, useMutation } from '@apollo/react-hooks';\r\n\r\nimport ThoughtList from '../components/ThoughtList';\r\nimport FriendList from '../components/FriendList';\r\nimport ThoughtForm from '../components/ThoughtForm';\r\n\r\nimport { QUERY_USER, QUERY_ME } from '../utils/queries';\r\n\r\nconst Profile = () => {\r\n  const { username: userParam } = useParams();\r\n\r\n  const [addFriend] = useMutation(ADD_FRIEND);\r\n\r\n  const { loading, data } = useQuery(userParam ? QUERY_USER : QUERY_ME, {\r\n    variables: { username: userParam }\r\n  });\r\n\r\n  const user = data?.me || data?.user || {};\r\n// redirect to personal profile page if username is the logged-in user's\r\nif (Auth.loggedIn() && Auth.getProfile().data.username === userParam) {\r\n  return <Redirect to=\"/profile\" />;\r\n}\r\n\r\n  if (loading) {\r\n    return <div>Loading...</div>;\r\n  }\r\n\r\n  if (!user?.username) {\r\n    return (\r\n      <h4>\r\n        You need to be logged in to see this page. Use the navigation links above to sign up or log in!\r\n      </h4>\r\n    );\r\n  }\r\n\r\n  const handleClick = async () => {\r\n    try {\r\n      await addFriend({\r\n        variables: { id: user._id }\r\n      });\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"flex-row mb-3\">\r\n      <h2 className=\"bg-dark text-secondary p-3 display-inline-block\">\r\n       Viewing {userParam ? `${user.username}'s` : 'your'} profile.\r\n      </h2>\r\n      {userParam && (\r\n  <button className=\"btn ml-auto\" onClick={handleClick}>\r\n    Add Friend\r\n  </button>\r\n)}\r\n      </div>\r\n\r\n      <div className=\"flex-row justify-space-between mb-3\">\r\n  <div className=\"col-12 mb-3 col-lg-8\">\r\n    <ThoughtList thoughts={user.thoughts} title={`${user.username}'s thoughts...`} />\r\n  </div>\r\n\r\n  <div className=\"col-12 col-lg-3 mb-3\">\r\n    <FriendList\r\n      username={user.username}\r\n      friendCount={user.friendCount}\r\n      friends={user.friends}\r\n    />\r\n  </div>\r\n</div>\r\n<div className=\"mb-3\">{!userParam && <ThoughtForm />}</div>\r\n    </div>\r\n  );\r\n};\r\nexport default Profile;\r\n"]},"metadata":{},"sourceType":"module"}